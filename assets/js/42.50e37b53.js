(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{566:function(_,r,t){"use strict";t.r(r);var v=t(1),e=Object(v.a)({},(function(){var _=this,r=_._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[r("p",[_._v("React Fiber 是 React 16 引入的核心算法重构，旨在解决大型应用渲染性能问题并支持异步渲染等新特性。其核心思想是通过可中断、优先级调度和增量渲染，优化用户交互体验。以下是 Fiber 架构的关键点：")]),_._v(" "),r("hr"),_._v(" "),r("h3",{attrs:{id:"_1-旧架构的瓶颈"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-旧架构的瓶颈"}},[_._v("#")]),_._v(" "),r("strong",[_._v("1. 旧架构的瓶颈")])]),_._v(" "),r("ul",[r("li",[r("strong",[_._v("Stack Reconciler")]),_._v("：递归遍历虚拟DOM树，无法中断任务，长时间任务会导致主线程阻塞（如动画卡顿）。")]),_._v(" "),r("li",[r("strong",[_._v("同步渲染")]),_._v("：一旦开始渲染，必须完成整个树的计算，无法响应用户交互（如输入延迟）。")])]),_._v(" "),r("hr"),_._v(" "),r("h3",{attrs:{id:"_2-fiber-的核心设计"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-fiber-的核心设计"}},[_._v("#")]),_._v(" "),r("strong",[_._v("2. Fiber 的核心设计")])]),_._v(" "),r("h4",{attrs:{id:"_1-fiber-节点"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-fiber-节点"}},[_._v("#")]),_._v(" "),r("strong",[_._v("（1）Fiber 节点")])]),_._v(" "),r("ul",[r("li",[_._v("将虚拟DOM节点抽象为"),r("strong",[_._v("Fiber节点")]),_._v("，保存组件类型、状态、副作用等信息。")]),_._v(" "),r("li",[_._v("数据结构：链表结构（"),r("code",[_._v("child")]),_._v(", "),r("code",[_._v("sibling")]),_._v(", "),r("code",[_._v("return")]),_._v("），替代树形结构，实现"),r("strong",[_._v("可中断遍历")]),_._v("。")])]),_._v(" "),r("h4",{attrs:{id:"_2-任务分割与调度"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-任务分割与调度"}},[_._v("#")]),_._v(" "),r("strong",[_._v("（2）任务分割与调度")])]),_._v(" "),r("ul",[r("li",[r("strong",[_._v("增量渲染")]),_._v("：将渲染任务拆分为多个小单元（Fiber节点处理），通过浏览器空闲时间（"),r("code",[_._v("requestIdleCallback")]),_._v("）分片执行。")]),_._v(" "),r("li",[r("strong",[_._v("优先级调度")]),_._v("：为不同更新（用户交互 > 动画 > 数据加载）分配优先级，高优先级任务可打断低优先级任务。")])]),_._v(" "),r("h4",{attrs:{id:"_3-双缓存机制"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-双缓存机制"}},[_._v("#")]),_._v(" "),r("strong",[_._v("（3）双缓存机制")])]),_._v(" "),r("ul",[r("li",[r("strong",[_._v("Current Tree")]),_._v("：当前显示的UI状态。")]),_._v(" "),r("li",[r("strong",[_._v("WorkInProgress Tree")]),_._v("：后台构建的新状态，完成后直接切换，减少渲染抖动。")])]),_._v(" "),r("hr"),_._v(" "),r("h3",{attrs:{id:"_3-fiber-的关键能力"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-fiber-的关键能力"}},[_._v("#")]),_._v(" "),r("strong",[_._v("3. Fiber 的关键能力")])]),_._v(" "),r("ul",[r("li",[r("strong",[_._v("可中断与恢复")]),_._v("：渲染过程可暂停，优先处理用户交互，再恢复剩余任务。")]),_._v(" "),r("li",[r("strong",[_._v("并发模式（Concurrent Mode）")]),_._v("：支持异步渲染，实现更流畅的交互（如Suspense延迟加载）。")]),_._v(" "),r("li",[r("strong",[_._v("错误边界")]),_._v("：通过组件生命周期（如"),r("code",[_._v("static getDerivedStateFromError")]),_._v("）捕获子树错误。")])]),_._v(" "),r("hr"),_._v(" "),r("h3",{attrs:{id:"_4-生命周期的影响"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4-生命周期的影响"}},[_._v("#")]),_._v(" "),r("strong",[_._v("4. 生命周期的影响")])]),_._v(" "),r("ul",[r("li",[r("strong",[_._v("废弃生命周期")]),_._v("："),r("code",[_._v("componentWillMount")]),_._v(", "),r("code",[_._v("componentWillUpdate")]),_._v("等可能被多次调用（因任务中断），由"),r("code",[_._v("getDerivedStateFromProps")]),_._v("等替代。")]),_._v(" "),r("li",[r("strong",[_._v("副作用分离")]),_._v("："),r("code",[_._v("useEffect")]),_._v("替代"),r("code",[_._v("componentDidMount")]),_._v("等，支持更灵活的副作用管理。")])]),_._v(" "),r("hr"),_._v(" "),r("h3",{attrs:{id:"_5-对开发者的意义"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5-对开发者的意义"}},[_._v("#")]),_._v(" "),r("strong",[_._v("5. 对开发者的意义")])]),_._v(" "),r("ul",[r("li",[r("strong",[_._v("更流畅的UI")]),_._v("：动画、输入等高优先级操作响应更快。")]),_._v(" "),r("li",[r("strong",[_._v("复杂应用优化")]),_._v("：大数据量列表、懒加载等场景性能提升。")]),_._v(" "),r("li",[r("strong",[_._v("未来特性基础")]),_._v("：支持并发模式（Concurrent Mode）、服务器组件（Server Components）等。")])]),_._v(" "),r("hr"),_._v(" "),r("h3",{attrs:{id:"总结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[_._v("#")]),_._v(" "),r("strong",[_._v("总结")])]),_._v(" "),r("p",[_._v("React Fiber 通过重新设计协调算法，将同步渲染改为异步可中断调度，解决了卡顿问题，并为 React 的长期演进奠定了基础。开发者无需直接操作 Fiber，但理解其原理有助于优化应用性能。")])])}),[],!1,null,null,null);r.default=e.exports}}]);